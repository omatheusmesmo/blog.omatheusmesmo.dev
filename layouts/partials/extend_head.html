{{- $styles := resources.Get "css/extended/custom.css" | resources.Minify | resources.Fingerprint -}}
{{- if $styles -}}
<link crossorigin="anonymous" href="{{ $styles.RelPermalink }}" integrity="{{ $styles.Data.Integrity }}" rel="preload stylesheet" as="style">
{{- end -}}

{{- /* SEO and Social Media Extras */ -}}
{{- if .IsHome -}}
<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "WebSite",
  "name": "{{ site.Title }}",
  "url": "{{ site.BaseURL }}",
  "description": "{{ site.Params.description }}",
  "potentialAction": {
    "@type": "SearchAction",
    "target": "{search_term_string}",
    "query-input": "required name=search_term_string"
  }
}
</script>
{{- end -}}

{{- if .IsHome -}}
  {{- $first_post := (where site.RegularPages "Section" "posts") | first 1 -}}
  {{- range $first_post -}}
    {{- with .Params.cover.image -}}
      {{- $img := $.Resources.GetMatch . -}}
      {{- if $img -}}
        {{- $optimized := $img.Resize "1080x webp q80" -}}
        <link rel="preload" as="image" href="{{ $optimized.RelPermalink }}" fetchpriority="high">
      {{- end -}}
    {{- end -}}
  {{- end -}}
{{- end -}}

<meta name="apple-mobile-web-app-title" content="{{ site.Title }}">
<meta name="application-name" content="{{ site.Title }}">
<meta name="msapplication-TileColor" content="#2e2e33">
<meta name="theme-color" content="#2e2e33">

{{- /* Security Headers (Hints for the browser) */ -}}
<meta http-equiv="Content-Security-Policy" content="upgrade-insecure-requests">
